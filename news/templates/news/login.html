{% extends 'news/auth_base.html' %}
{% load socialaccount %}

{% block title %}Sign in - Burst{% endblock %}

{% block auth_nav %}
<a href="{% url 'news:register' %}">Create account</a>
{% endblock %}

{% block auth_content %}
<svg class="auth-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
    <circle cx="12" cy="7" r="4"/>
</svg>
<h1 class="auth-title">Sign in</h1>

<form method="post" class="auth-form">
    {% csrf_token %}
    <div class="form-group">
        <label for="username" class="form-label">Username</label>
        <input type="text" id="username" name="username" class="form-control" required autofocus placeholder="Enter your username">
    </div>
    <div class="form-group password-toggle-wrap">
        <label for="password" class="form-label">Password</label>
        <input type="password" id="password" name="password" class="form-control" required placeholder="Enter your password">
        <button type="button" class="password-toggle-btn" aria-label="Show password" data-target="password">SHOW</button>
    </div>
    <button type="submit" class="btn btn-primary">OK, sign in using email</button>
</form>

{% get_providers as socialaccount_providers %}
{% if socialaccount_providers %}
<div class="auth-divider">Or sign in with</div>
<div class="auth-social">
    {% for provider in socialaccount_providers %}
    <a href="{% provider_login_url provider.id next='/' %}" class="auth-social-btn {{ provider.id }}" title="Sign in with {{ provider.name }}" aria-label="Sign in with {{ provider.name }}">
        {% if provider.id == 'apple' %}
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/></svg>
        {% else %}
        {{ provider.name|slice:":1" }}
        {% endif %}
    </a>
    {% endfor %}
</div>
{% endif %}

<p class="auth-existing">Don't have a profile? <a href="{% url 'news:register' %}">Create one</a></p>
<p><a href="{% url 'news:forgot_password' %}" style="font-size: 0.9rem; color: var(--color-text-muted);">Forgot your password?</a></p>

<script>
document.querySelectorAll('.password-toggle-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
        var id = this.getAttribute('data-target');
        var target = document.getElementById(id);
        if (!target) return;
        if (target.type === 'password') {
            target.type = 'text';
            this.textContent = 'HIDE';
        } else {
            target.type = 'password';
            this.textContent = 'SHOW';
        }
    });
});
</script>
{% endblock %}
